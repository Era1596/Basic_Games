<!DOCTYPE html>
<html>
<head>
    <title>Battleship Game</title>
    <style>
        /* ... (previous styles) ... */
        .cell {
            /* ... (previous cell styles) ... */
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div class="container">
        <h2>Battleship Game</h2>
        <div id="playerBoard"></div>
        <div id="opponentBoard"></div>
        <button onclick="startGame()">Start Game</button>
        <button onclick="placeShipsManually()">Place Ships Manually</button>
    </div>

    <script>
        const boardSize = 8;
        const shipSizes = [3, 2, 2, 1, 1]; // Ship sizes
        let playerBoard = [];
        let opponentBoard = [];

        function createBoard(boardId) {
            let html = '';
            for (let i = 0; i < boardSize; i++) {
                boardId[i] = [];
                html += '<div>';
                for (let j = 0; j < boardSize; j++) {
                    boardId[i][j] = 0;
                    html += '<div class="cell" onclick="cellClick(' + i + ',' + j + ', \'' + boardId + '\')"></div>';
                }
                html += '</div>';
            }
            document.getElementById(boardId).innerHTML = html;
        }

        function startGame() {
            createBoard('playerBoard');
            createBoard('opponentBoard');
        }

        function cellClick(row, col, boardId) {
            let board;
            if (boardId === 'playerBoard') {
                board = playerBoard;
            } else if (boardId === 'opponentBoard') {
                board = opponentBoard;
                // Prevent opponent board clicks
                return;
            }

            if (board[row][col] === 0) {
                if (boardId === 'playerBoard') {
                    board[row][col] = 1;
                    let cell = document.getElementsByClassName('cell')[row * boardSize + col];
                    cell.style.backgroundColor = 'blue';
                    if (!checkWin(board, 1)) {
                        opponentMove();
                    }
                } else if (boardId === 'opponentBoard') {
                    if (opponentBoard[row][col] === 0) {
                        opponentBoard[row][col] = 1;
                        let cell = document.getElementsByClassName('cell')[row * boardSize + col + boardSize * boardSize];
                        cell.style.backgroundColor = 'blue';
                        if (!checkWin(board, 2)) {
                            // Oyuncunun sıradaki hamlesini yapmasını beklemek için bir mekanizma eklenmedi, burada işaretleme yapılıyor sadece.
                        }
                    }
                }
            }
        }

        function opponentMove() {
            let bestScore = -Infinity;
            let move;
            for (let i = 0; i < boardSize; i++) {
                for (let j = 0; j < boardSize; j++) {
                    if (opponentBoard[i][j] === 0) {
                        opponentBoard[i][j] = 2;
                        let score = minimax(opponentBoard, 0, false);
                        opponentBoard[i][j] = 0;
                        if (score > bestScore) {
                            bestScore = score;
                            move = { row: i, col: j };
                        }
                    }
                }
            }
            opponentBoard[move.row][move.col] = 2;
            let cellIndex = move.row * boardSize + move.col + boardSize * boardSize;
            document.getElementsByClassName('cell')[cellIndex].style.backgroundColor = 'red';
            checkWin(opponentBoard, 2);
        }

        function checkWin(board, player) {
            // Check for a win condition and return true if the player wins
            // Implement your win condition logic here
            return false;
        }

        function placeShipsManually() {
            alert("Click on the board cells to place your ships.");

            let placedShips = 0;
            let currentShipSize = shipSizes[placedShips];
            document.getElementById('playerBoard').addEventListener('click', function(event) {
                if (placedShips < shipSizes.length) {
                    let cell = event.target;
                    let row = Math.floor(Array.from(cell.parentNode.children).indexOf(cell) / boardSize);
                    let col = Array.from(cell.parentNode.children).indexOf(cell) % boardSize;

                    if (isValidPlacement(playerBoard, row, col, currentShipSize)) {
                        for (let i = 0; i < currentShipSize; i++) {
                            if (i === 0) {
                                playerBoard[row][col + i] = 3; // Mark ship position as 3
                            } else {
                                playerBoard[row][col + i] = 4; // Mark rest of the ship positions as 4
                            }
                            let shipCell = document.getElementsByClassName('cell')[row * boardSize + col + i];
                            shipCell.style.backgroundColor = 'green';
                        }
                        placedShips++;
                        if (placedShips < shipSizes.length) {
                            currentShipSize = shipSizes[placedShips];
                        }
                    }

                    if (placedShips === shipSizes.length) {
                        alert("All ships have been placed.");
                        document.getElementById('playerBoard').removeEventListener('click', arguments.callee); // Remove event listener
                    }
                }
            });
        }

        function isValidPlacement(board, row, col, shipSize) {
            // Check if the ship can be placed in the given position
            for (let i = 0; i < shipSize; i++) {
                if (col + i >= boardSize || board[row][col + i] !== 0) {
                    return false;
                }
            }
            return true;
        }

        function minimax(board, depth, isMaximizing) {
            // ... (previous minimax function) ...
        }
    </script>
</body>
</html>
